(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[860],{3270:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/3-etc/3.2",function(){return n(3993)}])},3993:function(e,s,n){"use strict";n.r(s),n.d(s,{__toc:function(){return l}});var r=n(5893),t=n(2673),a=n(373),o=n(8426);n(9128);var i=n(2643);let l=[{depth:2,value:"(트러블슈팅) Cloud9 에서 AWS Credential 이 자주 Refresh 되는 이슈",id:"트러블슈팅-cloud9-에서-aws-credential-이-자주-refresh-되는-이슈"},{depth:2,value:"참고",id:"참고"},{depth:2,value:"증상",id:"증상"},{depth:2,value:"원인",id:"원인"},{depth:2,value:"해결방법",id:"해결방법"}];function _createMdxContent(e){let s=Object.assign({h2:"h2",p:"p",ul:"ul",li:"li",a:"a",pre:"pre",code:"code",span:"span"},(0,i.a)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"트러블슈팅-cloud9-에서-aws-credential-이-자주-refresh-되는-이슈",children:"(트러블슈팅) Cloud9 에서 AWS Credential 이 자주 Refresh 되는 이슈"}),"\n",(0,r.jsx)(s.p,{children:"에러 문구"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"error: You must be logged in to the server (the server has asked for the client to provide credentials)"}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.h2,{id:"참고",children:"참고"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://public-cloud.tistory.com/73",children:"https://public-cloud.tistory.com/73"})}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.h2,{id:"증상",children:"증상"}),"\n",(0,r.jsx)(s.pre,{"data-language":"bash","data-theme":"default",filename:"terminal",hasCopyCode:!0,children:(0,r.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"kubectl"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"create"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"namespace"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"argocd"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"error:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"You"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"must"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"be"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"logged"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"in"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"to"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"the"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"server"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (Unauthorized)"})]})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.h2,{id:"원인",children:"원인"}),"\n",(0,r.jsxs)(s.p,{children:["aws cloud 9 내에는 ",(0,r.jsx)(s.code,{children:"~/.aws/credentials"})," 라는 파일이 있는데 이 곳에서 아래의 환경변수들을 주기적으로 업데이트 한다."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"AWS_ACCESS_KEY_ID"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"AWS_SECRET_ACCESS_KEY"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"AWS_DEFAULT_REGION"})}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.p,{children:"AWS Cloud9 내의 기본 credentials 는 주기적으로 업데이트 되기 때문에, AdministratorAccess 가 포함된 cluster 사용자의 권한을 부여했던 액세스 키, 액세스 키 시크릿이 일정 시간이 지나면 사라지는 것이다."}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.h2,{id:"해결방법",children:"해결방법"}),"\n",(0,r.jsxs)(s.p,{children:["일정 권한을 가진 IAM User 를 생성한다. (내 경우에는 AdministratorAccess 를 가진 IAM 사용자 추가가 및 액세스 키, 액세스 시크릿 등을 발급해서 Cloud9 내의 환경변수로 export 해줬다.)",(0,r.jsx)("br",{}),"\r\n예를 들어 아래와 같은 쉘 스크립트를 통해 EKS가 내부적으로 환경변수로 인식하는 환경변수로 액세스 키 관련 환경변수를 선언해준다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.pre,{"data-language":"bash","data-theme":"default",filename:"terminal",hasCopyCode:!0,children:(0,r.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"export-access-key-gitops-study-argocd.sh"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" AWS_ACCESS_KEY_ID"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{액세스키"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ID}"})]}),"\n",(0,r.jsxs)(s.span,{className:"line highlighted",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" AWS_SECRET_ACCESS_KEY"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{액세스키"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"시크릿}"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" AWS_DEFAULT_REGION"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ap-northeast-2"})]})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(s.p,{children:["환경변수 활성화",(0,r.jsx)("br",{}),"\r\n위와 같은 쉘스크립트를 Cloud 9 에 접속할 때마다 아래의 명령을 수행해주거나 아래의 코드를 ",(0,r.jsx)(s.code,{children:"~/.bashrc"})," 에 정의해둔다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(s.pre,{"data-language":"bash","data-theme":"default",filename:"terminal",hasCopyCode:!0,children:(0,r.jsx)(s.code,{"data-language":"bash","data-theme":"default",children:(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"source"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"export-acess-key-gitops-study-argocd.sh"})]})})})]})}let c={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.a)(),e.components);return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/3-etc/3.2.mdx",route:"/3-etc/3.2",timestamp:1706501823e3,pageMap:[{kind:"Folder",name:"0-setup-access-tools",route:"/0-setup-access-tools",children:[{kind:"MdxPage",name:"0.1",route:"/0-setup-access-tools/0.1"},{kind:"MdxPage",name:"0.2",route:"/0-setup-access-tools/0.2"},{kind:"MdxPage",name:"0.3",route:"/0-setup-access-tools/0.3"},{kind:"MdxPage",name:"0.4",route:"/0-setup-access-tools/0.4"},{kind:"MdxPage",name:"0.5",route:"/0-setup-access-tools/0.5"},{kind:"Meta",data:{"0.1":"1.Administrator 권한의 IAM User, Access Key, Access Key Secret 생성","0.2":"2.AWS Cloud 9 셋업","0.3":"3.EKS, k8s 접근 도구 셋업","0.4":"4.Cloud9 의 Access Key, Access Key Secret 새로고침문제 해결방법","0.5":"5.ArgoCD ALB 용도의 Ingress 에 서브넷 지정, 보안 그룹 생성"}}]},{kind:"Folder",name:"1-create-an-eks",route:"/1-create-an-eks",children:[{kind:"MdxPage",name:"1.0",route:"/1-create-an-eks/1.0"},{kind:"MdxPage",name:"1.1",route:"/1-create-an-eks/1.1"},{kind:"MdxPage",name:"1.2",route:"/1-create-an-eks/1.2"},{kind:"MdxPage",name:"1.3",route:"/1-create-an-eks/1.3"},{kind:"MdxPage",name:"1.4",route:"/1-create-an-eks/1.4"},{kind:"MdxPage",name:"1.5",route:"/1-create-an-eks/1.5"},{kind:"MdxPage",name:"1.6",route:"/1-create-an-eks/1.6"},{kind:"Meta",data:{"1.0":"0. 소개","1.1":"1. eksctl 을 사용해 EKS Cluster 생성","1.2":"2. eksctl 을 사용해 EKS Nodegroup 생성","1.3":"3. Managed Nodegroup 삭제","1.4":"4. EKS 추가기능 (VPC CNI, CSI 드라이버, kube-proxy, CoreDNS) 설치","1.5":"5. oidc 조회 및 클러스터 service account 생성","1.6":"6. helm 을 이용해 aws-load-balancer-controller 생성"}}]},{kind:"Folder",name:"2-setup-argocd",route:"/2-setup-argocd",children:[{kind:"MdxPage",name:"2.1",route:"/2-setup-argocd/2.1"},{kind:"MdxPage",name:"2.2",route:"/2-setup-argocd/2.2"},{kind:"MdxPage",name:"2.3",route:"/2-setup-argocd/2.3"},{kind:"MdxPage",name:"2.4",route:"/2-setup-argocd/2.4"},{kind:"Meta",data:{"2.1":"1. ArgoCD 공식 제공 yml 을 이용해 ArgoCD 설치","2.2":"2. ArgoCD 구축 (2) ArgoCD 에 HTTP 허용","2.3":"3. 80포트 허용된 ArgoCD 에 Ingress URL 을 통해 접속해보기","2.4":"4. ArgoCD 의 Default Password 변경"}}]},{kind:"Folder",name:"3-etc",route:"/3-etc",children:[{kind:"MdxPage",name:"3.1",route:"/3-etc/3.1"},{kind:"MdxPage",name:"3.2",route:"/3-etc/3.2"},{kind:"Meta",data:{"3.1":"주요 공식자료들","3.2":"(트러블슈팅) Cloud9 에서 AWS Credential 이 자주 Refresh 되는 이슈"}}]},{kind:"MdxPage",name:"about",route:"/about"},{kind:"Folder",name:"advanced",route:"/advanced",children:[{kind:"MdxPage",name:"satori",route:"/advanced/satori"},{kind:"Meta",data:{satori:"Satori"}}]},{kind:"MdxPage",name:"advanced",route:"/advanced"},{kind:"MdxPage",name:"another",route:"/another"},{kind:"MdxPage",name:"index",route:"/"},{kind:"Meta",data:{"0-setup-access-tools":"접근 환경 구성","1-create-an-eks":"EKS 생성 & 셋업","2-setup-argocd":"EKS 내에 ArgoCD 구축","3-etc":"etc",index:"Introduction",another:"Another Page",advanced:"Advanced (A Folder)",about:{title:"About",type:"page"},contact:{title:"Contact ↗",type:"page",href:"-",newWindow:!0}}}],flexsearch:{codeblocks:!0},title:"3.2",headings:l},pageNextRoute:"/3-etc/3.2",nextraLayout:a.ZP,themeConfig:o.Z};s.default=(0,t.j)(c)},8426:function(e,s,n){"use strict";var r=n(5893);n(7294);let t={logo:(0,r.jsx)("span",{children:"ArgoCD를 EKS설치하는 과정들"}),project:{link:"https://github.com/chagchagchag/docs-argocd-setup-at-eks"},docsRepositoryBase:"https://github.com/chagchagchag/docs-argocd-setup-at-eks",footer:{text:"Nextra Docs Template"}};s.Z=t},5789:function(){}},function(e){e.O(0,[774,796,888,179],function(){return e(e.s=3270)}),_N_E=e.O()}]);