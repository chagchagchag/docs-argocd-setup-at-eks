(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[400],{2325:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/1-create-an-eks/1.2",function(){return n(4772)}])},4772:function(e,s,n){"use strict";n.r(s),n.d(s,{__toc:function(){return i}});var a=n(5893),r=n(2673),t=n(373),o=n(8426);n(9128);var c=n(2643);let i=[{depth:2,value:"2. eksctl 을 사용해 EKS Nodegroup 생성",id:"2-eksctl-을-사용해-eks-nodegroup-생성"}];function _createMdxContent(e){let s=Object.assign({h2:"h2",p:"p",pre:"pre",code:"code",span:"span",img:"img"},(0,c.a)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h2,{id:"2-eksctl-을-사용해-eks-nodegroup-생성",children:"2. eksctl 을 사용해 EKS Nodegroup 생성"}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsxs)(s.p,{children:["이미 배포되어있는 m5.large 타입의 인스턴스 2기를 t3.small 로 교체해주려고 하는데, 항상 그렇듯 물리적으로 한번에 교체하는 것은 불가능합니다. 이미 구동중인 m5.large 는 그대로 둔 상태에서 t3.small 기반의 클러스터를 배포합니다. 그리고 남아있는 m5.large 인스턴스 두기는 삭제합니다. 이번 문서에서는 t3.small 인스턴스 2 기를 배포하는 과정을 설명합니다.",(0,a.jsx)("br",{}),"\r\nminimum-cluster.yml 이라는 이름의 파일을 생성하고 아래의 yml 명세서를 작성합니다.",(0,a.jsx)("br",{})]}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsx)(s.pre,{"data-language":"bash","data-theme":"default",filename:"minimal-cluster.yaml",hasCopyCode:!0,children:(0,a.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"---"})}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"apiVersion:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"eksctl.io/v1alpha5"})]}),"\n",(0,a.jsxs)(s.span,{className:"line highlighted",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"kind:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ClusterConfig"})]}),"\n",(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"metadata:"})}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"name:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"gitops-study-k8scluster"})]}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"region:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ap-northeast-2"})]}),"\n",(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"managedNodeGroups:"})}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"-"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"name:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ng-workers"})]}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"labels:"})]}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"role:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"workers"})]}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"instanceType:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"t3.small"})]}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"desiredCapacity:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"})]}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"volumeSize:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20"})]}),"\n",(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"privateNetworking:"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"true"})]})]})}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsxs)(s.p,{children:["그리고 아래의 eksctl 커맨드를 실행합니다.",(0,a.jsx)("br",{})]}),"\n",(0,a.jsx)(s.pre,{"data-language":"bash","data-theme":"default",filename:"terminal",hasCopyCode:!0,children:(0,a.jsx)(s.code,{"data-language":"bash","data-theme":"default",children:(0,a.jsxs)(s.span,{className:"line",children:[(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"eksctl"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"create"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"nodegroup"}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--config-file=minimum-cluster.yml"})]})})}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsxs)(s.p,{children:["Cloud 9 내에서 적용한 모습",(0,a.jsx)("br",{}),"\r\n",(0,a.jsx)(s.img,{src:"https://raw.githubusercontent.com/chagchagchag/docs-argocd-setup-at-eks/main/pages/1-create-an-eks/img/CLUSTER-SETUP-2-EKSCTL-NODEGROUP-CREATION/1.png",alt:""})]}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsxs)(s.p,{children:["생성중인 노드는 콘솔에서 확인 가능합니다.",(0,a.jsx)("br",{}),"\r\n",(0,a.jsx)(s.img,{src:"https://raw.githubusercontent.com/chagchagchag/docs-argocd-setup-at-eks/main/pages/1-create-an-eks/img/CLUSTER-SETUP-2-EKSCTL-NODEGROUP-CREATION/2.png",alt:""}),"\r\n새로 생성되는 중인 노드그룹은 ng-workers 입니다. ng-99fc00b4 라는 이름으로 이미 생성중인 노드 그룹은 노드의 인스턴스 크기가 커서 비용과금될 가능성이 크기 때문에 삭제할 예정입니다.",(0,a.jsx)("br",{}),"\r\nng-workers 를 새로 만든 후에 ng-99fc00b4 을 삭제하는 이유는 이미 만들어둔 ng-99fc00b4 을 생성하면서 배포되어 있는 시스템 리소스들이 존재하는데 이 리소스들이 기존의 ec2 노드들에 자리잡고 있다. 그런데 이것을 삭제해버리면 이 노드들이 죽은 상태로 존재하게 됩니다.",(0,a.jsx)("br",{}),"\r\n따라서 ng-workers 를 새로 추가 후에 ng-99fc00b4 를 삭제하면 기존에 생성된 노드들이 ng-workers 로 자연스럽게 이동이 될수 있기에 생성 후 삭제를 선택했습니다.",(0,a.jsx)("br",{})]}),"\n",(0,a.jsx)("br",{})]})}let l={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,c.a)(),e.components);return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/1-create-an-eks/1.2.mdx",route:"/1-create-an-eks/1.2",timestamp:1706489834e3,pageMap:[{kind:"Folder",name:"0-setup-access-tools",route:"/0-setup-access-tools",children:[{kind:"MdxPage",name:"0.1",route:"/0-setup-access-tools/0.1"},{kind:"MdxPage",name:"0.2",route:"/0-setup-access-tools/0.2"},{kind:"MdxPage",name:"0.3",route:"/0-setup-access-tools/0.3"},{kind:"MdxPage",name:"0.4",route:"/0-setup-access-tools/0.4"},{kind:"MdxPage",name:"0.5",route:"/0-setup-access-tools/0.5"},{kind:"Meta",data:{"0.1":"1.Administrator 권한의 IAM User, Access Key, Access Key Secret 생성","0.2":"2.AWS Cloud 9 셋업","0.3":"3.EKS, k8s 접근 도구 셋업","0.4":"4.Cloud9 의 Access Key, Access Key Secret 새로고침문제 해결방법","0.5":"5.ArgoCD ALB 용도의 Ingress 에 서브넷 지정, 보안 그룹 생성"}}]},{kind:"Folder",name:"1-create-an-eks",route:"/1-create-an-eks",children:[{kind:"MdxPage",name:"1.0",route:"/1-create-an-eks/1.0"},{kind:"MdxPage",name:"1.1",route:"/1-create-an-eks/1.1"},{kind:"MdxPage",name:"1.2",route:"/1-create-an-eks/1.2"},{kind:"MdxPage",name:"1.3",route:"/1-create-an-eks/1.3"},{kind:"MdxPage",name:"1.4",route:"/1-create-an-eks/1.4"},{kind:"MdxPage",name:"1.5",route:"/1-create-an-eks/1.5"},{kind:"MdxPage",name:"1.6",route:"/1-create-an-eks/1.6"},{kind:"Meta",data:{"1.0":"0. 소개","1.1":"1. eksctl 을 사용해 EKS Cluster 생성","1.2":"2. eksctl 을 사용해 EKS Nodegroup 생성","1.3":"3. Managed Nodegroup 삭제","1.4":"4. EKS 추가기능 (VPC CNI, CSI 드라이버, kube-proxy, CoreDNS) 설치","1.5":"5. oidc 조회 및 클러스터 service account 생성","1.6":"6. helm 을 이용해 aws-load-balancer-controller 생성"}}]},{kind:"Folder",name:"2-setup-argocd",route:"/2-setup-argocd",children:[{kind:"MdxPage",name:"2.1",route:"/2-setup-argocd/2.1"},{kind:"MdxPage",name:"2.2",route:"/2-setup-argocd/2.2"},{kind:"MdxPage",name:"2.3",route:"/2-setup-argocd/2.3"},{kind:"MdxPage",name:"2.4",route:"/2-setup-argocd/2.4"},{kind:"Meta",data:{"2.1":"1. ArgoCD 공식 제공 yml 을 이용해 ArgoCD 설치","2.2":"2. ArgoCD 구축 (2) ArgoCD 에 HTTP 허용","2.3":"3. 80포트 허용된 ArgoCD 에 Ingress URL 을 통해 접속해보기","2.4":"4. ArgoCD 의 Default Password 변경"}}]},{kind:"Folder",name:"3-etc",route:"/3-etc",children:[{kind:"MdxPage",name:"3.1",route:"/3-etc/3.1"},{kind:"MdxPage",name:"3.2",route:"/3-etc/3.2"},{kind:"Meta",data:{"3.1":"주요 공식자료들","3.2":"(트러블슈팅) Cloud9 에서 AWS Credential 이 자주 Refresh 되는 이슈"}}]},{kind:"MdxPage",name:"about",route:"/about"},{kind:"Folder",name:"advanced",route:"/advanced",children:[{kind:"MdxPage",name:"satori",route:"/advanced/satori"},{kind:"Meta",data:{satori:"Satori"}}]},{kind:"MdxPage",name:"advanced",route:"/advanced"},{kind:"MdxPage",name:"another",route:"/another"},{kind:"MdxPage",name:"index",route:"/"},{kind:"Meta",data:{"0-setup-access-tools":"접근 환경 구성","1-create-an-eks":"EKS 생성 & 셋업","2-setup-argocd":"EKS 내에 ArgoCD 구축","3-etc":"etc",index:"Introduction",another:"Another Page",advanced:"Advanced (A Folder)",about:{title:"About",type:"page"},contact:{title:"Contact ↗",type:"page",href:"-",newWindow:!0}}}],flexsearch:{codeblocks:!0},title:"1.2",headings:i},pageNextRoute:"/1-create-an-eks/1.2",nextraLayout:t.ZP,themeConfig:o.Z};s.default=(0,r.j)(l)},8426:function(e,s,n){"use strict";var a=n(5893);n(7294);let r={logo:(0,a.jsx)("span",{children:"My Project"}),project:{link:"https://github.com/chagchagchag/docs-argocd-setup-at-eks"},docsRepositoryBase:"https://github.com/chagchagchag/docs-argocd-setup-at-eks",footer:{text:"Nextra Docs Template"}};s.Z=r},5789:function(){}},function(e){e.O(0,[774,796,888,179],function(){return e(e.s=2325)}),_N_E=e.O()}]);